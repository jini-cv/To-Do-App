<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>To‑Do List — Minimal, Fast, Accessible</title>
  <meta name="description" content="A lightweight, client-side To-Do List built with HTML, CSS, and JavaScript. Supports add, edit, delete, complete, filter, search, and local persistence." />
  <style>
    :root {
      --bg: #0b0c10;
      --panel: #121318;
      --text: #e6e6e6;
      --muted: #a3a3a3;
      --accent: #6ee7b7;
      --accent-2: #7aa2ff;
      --danger: #ff6b6b;
      --border: #24262e;
      --shadow: 0 10px 30px rgba(0,0,0,.45);
      --radius: 16px;
    }
    @media (prefers-color-scheme: light) {
      :root {
        --bg: #f6f7fb;
        --panel: #ffffff;
        --text: #111827;
        --muted: #6b7280;
        --accent: #0ea5e9;
        --accent-2: #16a34a;
        --danger: #ef4444;
        --border: #e5e7eb;
        --shadow: 0 10px 30px rgba(0,0,0,.08);
      }
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Inter, Ubuntu, Cantarell, "Noto Sans", "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: radial-gradient(1200px 800px at 10% -10%, rgba(110,231,183,.15), transparent 50%),
                  radial-gradient(1000px 700px at 110% 10%, rgba(122,162,255,.15), transparent 40%),
                  var(--bg);
    }

    .wrap {
      max-width: 860px;
      margin: 40px auto;
      padding: 20px;
    }
    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    header.app-header {
      padding: 28px 28px 10px;
      display: flex;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
      border-bottom: 1px solid var(--border);
    }
    .app-title {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .logo {
      width: 42px; height: 42px;
      display: grid; place-items: center;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #0b0c10;
      font-weight: 800;
    }
    h1 { font-size: 1.35rem; margin: 0; }
    .muted { color: var(--muted); }
    .spacer { flex: 1; }

    form#add-form {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      width: 100%;
      padding: 18px 28px 24px;
      border-bottom: 1px solid var(--border);
    }
    .input {
      height: 44px;
      border: 1px solid var(--border);
      background: transparent;
      border-radius: 12px;
      padding: 10px 12px;
      color: var(--text);
      outline: none;
    }
    .input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px color-mix(in oklab, var(--accent) 30%, transparent); }
    .btn {
      height: 44px;
      padding: 0 16px;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text);
      border-radius: 12px;
      cursor: pointer;
      transition: transform .06s ease, background .2s ease, border-color .2s ease;
    }
    .btn:active { transform: translateY(1px); }
    .btn-primary {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #0b0c10;
      border: none;
      font-weight: 700;
    }
    .btn-danger { border-color: color-mix(in oklab, var(--danger) 50%, var(--border)); color: var(--danger); }
    .controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      padding: 14px 28px;
      align-items: center;
      border-bottom: 1px solid var(--border);
    }
    .chip {
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: 999px;
      cursor: pointer;
      user-select: none;
    }
    .chip[aria-pressed="true"] {
      border-color: var(--accent);
      outline: 3px solid color-mix(in oklab, var(--accent) 35%, transparent);
    }
    .list {
      list-style: none;
      margin: 0;
      padding: 6px 10px 8px;
      max-height: 60vh;
      overflow: auto;
      overscroll-behavior: contain;
    }
    .item {
      display: grid;
      grid-template-columns: auto 1fr auto;
      gap: 10px;
      align-items: center;
      padding: 10px 12px;
      border-radius: 12px;
      transition: background .2s ease;
    }
    .item:hover { background: color-mix(in oklab, var(--panel) 70%, #ffffff10); }
    .check {
      width: 20px; height: 20px;
    }
    .title {
      padding: 8px 10px;
      border-radius: 8px;
      min-height: 36px;
      word-break: break-word;
    }
    .title.completed { text-decoration: line-through; opacity: .6; }
    .actions { display: flex; gap: 8px; }
    .small { font-size: .9rem; }

    footer.app-footer {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      padding: 14px 28px 22px;
      border-top: 1px solid var(--border);
    }
    .count { color: var(--muted); }
    .sr-only {
      position: absolute !important;
      width: 1px; height: 1px;
      padding: 0; margin: -1px;
      overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0;
    }

    @media (max-width: 640px) {
      header.app-header { padding: 20px; }
      form#add-form { padding: 14px 20px 20px; }
      .controls { padding: 12px 20px; }
      .list { padding: 6px; }
      footer.app-footer { padding: 12px 20px 18px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="application" aria-label="To-Do List Application">
      <header class="app-header">
        <div class="app-title">
          <div class="logo" aria-hidden="true">✓</div>
          <div>
            <h1>To‑Do List</h1>
            <div class="muted small">Fast • Offline • No accounts</div>
          </div>
        </div>
        <div class="spacer"></div>
        <button class="btn" id="exportBtn" aria-label="Export tasks to JSON">Export</button>
        <input type="file" id="importInput" accept="application/json" class="sr-only" />
        <button class="btn" id="importBtn" aria-label="Import tasks from JSON">Import</button>
      </header>

      <form id="add-form" autocomplete="off" aria-label="Add a new task">
        <input id="new-task" class="input" name="task" type="text" placeholder="What do you need to do?" aria-label="Task title" />
        <button class="btn btn-primary" type="submit" aria-label="Add task">Add</button>
      </form>

      <div class="controls" aria-label="Filters and search">
        <div role="group" aria-label="Filter tasks">
          <button class="chip" data-filter="all" aria-pressed="true">All</button>
          <button class="chip" data-filter="active" aria-pressed="false">Active</button>
          <button class="chip" data-filter="completed" aria-pressed="false">Completed</button>
        </div>
        <div class="spacer"></div>
        <input id="search" class="input" type="search" placeholder="Search tasks…" aria-label="Search tasks" style="max-width: 280px; width: 100%;" />
        <button class="btn btn-danger" id="clearCompletedBtn" aria-label="Clear completed tasks">Clear Completed</button>
      </div>

      <ul id="list" class="list" role="list" aria-live="polite" aria-relevant="additions removals">
        <!-- Tasks render here -->
      </ul>

      <footer class="app-footer">
        <div class="count" id="count">0 items</div>
        <div class="muted small">Tip: Press <kbd>Enter</kbd> to add, <kbd>Esc</kbd> to cancel editing.</div>
      </footer>
    </div>
  </div>

  <template id="item-template">
    <li class="item" role="listitem">
      <input type="checkbox" class="check" aria-label="Mark as complete" />
      <div class="title" contenteditable="false" spellcheck="false"></div>
      <div class="actions">
        <button class="btn small" data-action="edit" aria-label="Edit task">Edit</button>
        <button class="btn small" data-action="delete" aria-label="Delete task">Delete</button>
      </div>
    </li>
  </template>

  <script>
    (function () {
      const STORAGE_KEY = "todo.tasks.v1";
      const listEl = document.getElementById("list");
      const formEl = document.getElementById("add-form");
      const inputEl = document.getElementById("new-task");
      const countEl = document.getElementById("count");
      const template = document.getElementById("item-template");
      const searchEl = document.getElementById("search");
      const clearCompletedBtn = document.getElementById("clearCompletedBtn");
      const importBtn = document.getElementById("importBtn");
      const importInput = document.getElementById("importInput");
      const exportBtn = document.getElementById("exportBtn");

      let state = {
        tasks: [],
        filter: "all",
        query: ""
      };

      // Utilities
      const uid = () => crypto.randomUUID ? crypto.randomUUID() : String(Date.now() + Math.random());
      const save = () => localStorage.setItem(STORAGE_KEY, JSON.stringify(state.tasks));
      const load = () => {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          return Array.isArray(JSON.parse(raw)) ? JSON.parse(raw) : [];
        } catch { return []; }
      };
      const plural = (n, w) => n + " " + w + (n === 1 ? "" : "s");

      function setFilter(next) {
        state.filter = next;
        document.querySelectorAll('.chip[data-filter]').forEach(chip => {
          chip.setAttribute('aria-pressed', chip.dataset.filter === next ? 'true' : 'false');
        });
        render();
      }

      function addTask(title) {
        const t = title.trim();
        if (!t) return;
        state.tasks.unshift({ id: uid(), title: t, completed: false, createdAt: Date.now() });
        save();
        render();
      }

      function updateTask(id, patch) {
        const idx = state.tasks.findIndex(t => t.id === id);
        if (idx !== -1) {
          state.tasks[idx] = { ...state.tasks[idx], ...patch };
          save();
          render();
        }
      }

      function deleteTask(id) {
        state.tasks = state.tasks.filter(t => t.id !== id);
        save();
        render();
      }

      function clearCompleted() {
        state.tasks = state.tasks.filter(t => !t.completed);
        save();
        render();
      }

      function filtered() {
        const q = state.query.toLowerCase();
        return state.tasks.filter(t => {
          const matchQuery = !q || t.title.toLowerCase().includes(q);
          const matchFilter =
            state.filter === "all" ? true :
            state.filter === "active" ? !t.completed :
            t.completed;
          return matchQuery && matchFilter;
        });
      }

      function render() {
        listEl.innerHTML = "";
        const items = filtered();
        for (const t of items) {
          const node = template.content.firstElementChild.cloneNode(true);
          const checkbox = node.querySelector(".check");
          const title = node.querySelector(".title");
          const editBtn = node.querySelector('[data-action="edit"]');
          const delBtn  = node.querySelector('[data-action="delete"]');

          title.textContent = t.title;
          title.classList.toggle("completed", t.completed);
          checkbox.checked = t.completed;

          // Toggle complete
          checkbox.addEventListener("change", () => updateTask(t.id, { completed: !t.completed }));

          // Delete
          delBtn.addEventListener("click", () => deleteTask(t.id));

          // Edit (inline, with ESC to cancel and blur/Enter to save)
          editBtn.addEventListener("click", () => startEdit(title, t, editBtn));
          title.addEventListener("dblclick", () => startEdit(title, t, editBtn));

          node.addEventListener("keydown", (e) => {
            if (e.key === "Delete" && (e.ctrlKey || e.metaKey)) {
              e.preventDefault(); deleteTask(t.id);
            }
          });

          listEl.appendChild(node);
        }
        // Count
        const remaining = state.tasks.filter(t => !t.completed).length;
        countEl.textContent = `${plural(remaining, "item")} left`;
      }

      function startEdit(titleEl, task, btnEl) {
        if (titleEl.isContentEditable) return;
        const original = task.title;
        titleEl.contentEditable = "true";
        titleEl.focus();
        placeCaretAtEnd(titleEl);
        btnEl.textContent = "Save";
        const cleanup = () => {
          titleEl.contentEditable = "false";
          btnEl.textContent = "Edit";
        };
        const onKey = (e) => {
          if (e.key === "Enter") { e.preventDefault(); commit(); }
          if (e.key === "Escape") { e.preventDefault(); titleEl.textContent = original; cleanup(); }
        };
        const commit = () => {
          const next = titleEl.textContent.trim();
          if (!next) { titleEl.textContent = original; cleanup(); return; }
          if (next !== original) updateTask(task.id, { title: next });
          cleanup();
        };
        const onBlur = () => commit();
        titleEl.addEventListener("keydown", onKey, { once: true });
        titleEl.addEventListener("blur", onBlur, { once: true });
      }

      function placeCaretAtEnd(el) {
        const range = document.createRange();
        range.selectNodeContents(el);
        range.collapse(false);
        const sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);
      }

      // Event wiring
      formEl.addEventListener("submit", (e) => {
        e.preventDefault();
        addTask(inputEl.value);
        inputEl.value = "";
        inputEl.focus();
      });

      document.querySelectorAll('.chip[data-filter]').forEach(chip => {
        chip.addEventListener('click', () => setFilter(chip.dataset.filter));
      });

      searchEl.addEventListener("input", () => {
        state.query = searchEl.value;
        render();
      });

      clearCompletedBtn.addEventListener("click", () => {
        if (state.tasks.some(t => t.completed)) clearCompleted();
      });

      // Import/Export
      exportBtn.addEventListener("click", () => {
        const blob = new Blob([JSON.stringify(state.tasks, null, 2)], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "tasks.json";
        a.click();
        URL.revokeObjectURL(url);
      });
      importBtn.addEventListener("click", () => importInput.click());
      importInput.addEventListener("change", async (e) => {
        const file = e.target.files?.[0];
        if (!file) return;
        try {
          const text = await file.text();
          const data = JSON.parse(text);
          if (Array.isArray(data)) {
            // normalize
            state.tasks = data.map(d => ({
              id: d.id || uid(),
              title: String(d.title || "").trim(),
              completed: Boolean(d.completed),
              createdAt: d.createdAt || Date.now()
            })).filter(d => d.title);
            save(); render();
          } else {
            alert("Invalid file format.");
          }
        } catch {
          alert("Could not import. Ensure it's a valid JSON exported from this app.");
        } finally {
          e.target.value = "";
        }
      });

      // Init
      state.tasks = load();
      render();
      inputEl.focus();
    })();
  </script>
</body>
</html>
